{%- from "govuk_frontend_jinja/components/table/macro.html" import govukTable -%}
{% macro criteria_element(sub_criterias, name, name_classes, total_criteria_score, total_criteria_score_possible, weighting) %}
    {% set rows = [] %}
    {% for sub_criteria in sub_criterias %}
        {%
        set _ = rows.append([
        { "html": '<a class="govuk-link" href="criteria/{}">{}</a>'.format(sub_criteria.id, sub_criteria.name) },
        { "text": sub_criteria.theme_count, "classes": "gov-uk-table__cell--align-right" },
        { "text": sub_criteria.score, "classes": "gov-uk-table__cell--align-right" },
        { "html": '<span class="govuk-tag--scored-criteria">{}</span>'.format(sub_criteria.status), "classes": "gov-uk-table__cell--align-right" }
        ])
        %}
    {% endfor %}
    {%
    set _ = rows.append([
    { "html": "<strong>Total criteria score</strong>" },
    { "text": "" },
    { "text": "" },
    { "text": "{} of {}".format(total_criteria_score, total_criteria_score_possible), "classes": "gov-uk-table__cell--align-right" },
    ])
    %}
    <h3 class="{{ name_classes or '' }}">{{ name }}</h3>
    <p class="govuk-body govuk-!-margin-bottom-2">
        <strong>{{ (weighting * 100)|int }}%</strong> of overall score.
    </p>
    {{
    govukTable({
    "firstCellIsHeader":false,
    "head":[
    { "text": "Sub criteria" },
    { "text": "Number of sections", "classes": "gov-uk-table__cell--align-right" },
    { "text": "Score out of 5", "classes": "gov-uk-table__cell--align-right" },
    { "text": "Status", "classes": "gov-uk-table__cell--align-right" }
    ],
    "rows": rows,
    "classes": "govuk-!-margin-bottom-6 govuk-table-no-bottom-border"
    })
    }}
{% endmacro %}
